#Model Awal

from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression


# 1. Menentukan fitur dan target
X = df[['sqft_living', 'grade', 'bathrooms']]
y = df['price']

# Membagi data menjadi data latih dan data uji
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

# 2. Membuat dan melatih model
model = LinearRegression()
model.fit(X_train, y_train)

# 3. Prediksi pada data uji
y_pred = model.predict(X_test)

#Test
# Prediksi pada data uji
y_pred = model.predict(X_test)

pd.DataFrame({
    'Harga Aktual': y_test.values[:5],
    'Harga Prediksi': y_pred[:5]
})

coef_df = pd.DataFrame({
    'Fitur': X.columns,
    'Koefisien': model.coef_
})
coef_df

#Hasil
from sklearn.metrics import mean_absolute_error, mean_squared_error, r2_score
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Evaluasi model Linear Regression
mae = mean_absolute_error(y_test, y_pred)
mse = mean_squared_error(y_test, y_pred)
rmse = np.sqrt(mse)
r2 = r2_score(y_test, y_pred)

# Tabel hasil evaluasi
eval_lr = pd.DataFrame({
    "Metric": ["MAE", "MSE", "RMSE", "R2"],
    "Value": [mae, mse, rmse, r2]
})


#Evaluasi menggunakan model baru
from sklearn.metrics import mean_absolute_error, mean_squared_error, r2_score
import numpy as np
import pandas as pd

# Evaluasi Linear Regression
mae_lr = mean_absolute_error(y_test, y_pred)
mse_lr = mean_squared_error(y_test, y_pred)
rmse_lr = np.sqrt(mse_lr)
r2_lr = r2_score(y_test, y_pred)

eval_lr = pd.DataFrame({
    "Model": ["Linear Regression"],
    "MAE": [mae_lr],
    "MSE": [mse_lr],
    "RMSE": [rmse_lr],
    "R2": [r2_lr]
})

eval_lr

from sklearn.ensemble import RandomForestRegressor

# Membuat model Random Forest
rf_model = RandomForestRegressor(
    n_estimators=200,
    random_state=42
)

# Training model
rf_model.fit(X_train, y_train)
â€¦eval_rf = pd.DataFrame({
    "Model": ["Random Forest"],
    "MAE": [mae_rf],
    "MSE": [mse_rf],
    "RMSE": [rmse_rf],
    "R2": [r2_rf]
})

eval_rf

comparison = pd.concat([eval_lr, eval_rf], ignore_index=True)
comparison



